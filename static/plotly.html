<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />
    <link rel="stylesheet" href="plotly.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>
    <script src="https://cdn.plot.ly/plotly-2.3.0.min.js"></script>
    <title>Tensiometric chart</title>
</head>

<body>
    <script>
    function predictRegime(){
      const XHR = new XMLHttpRequest(),
      FD  = new FormData();

      var x = document.getElementById("hstar").value;
      var y = document.getElementById("bstar").value;
      // Push our data into our FormData object
      FD.append( "b_input", x );
      FD.append( "h_input", y );

      XHR.open( 'POST', 'http://127.0.0.1:5000/predict/regime' );

      // Send our FormData object; HTTP headers are set automatically
      XHR.send(FD);
      XHR.onload = function(){
          console.log(XHR.response)
          var x = XHR.response
          str =""
          if (x == "10"){
             str = "Bowl" 
          }
          if(x == "11"){
            str = "Bell"
          }
          if(x == "12"){
            str = "Balloon"
          }
          if(x == "13"){
            str = "Bulb"
          }
          //document.getElementById("shape").innerHTML = "Regime Shape= "+ str;
      }  
    }
    function predictContactAngle(){
        var x = document.getElementById("hstar").value;
        var y = document.getElementById("bstar").value;
        const XHR1 = new XMLHttpRequest(),
        FD1  = new FormData();
        FD1.append( "x", x );
        FD1.append( "y", y );
        XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/contactAngle' );
        // Send our FormData object; HTTP headers are set automatically
        XHR1.send(FD1);
        XHR1.onload = function(){
            var x = XHR1.response
            console.log(x)
            //document.getElementById("res").innerHTML ="Contact Angle = "+ parseFloat(x).toFixed(4)+"<span>&#176;</span>";
      } 
    }
    function predictShapeIndex(){
        var x = document.getElementById("hstar").value;
        var y = document.getElementById("bstar").value;
        const XHR1 = new XMLHttpRequest(),
        FD1  = new FormData();
        FD1.append( "x", x );
        FD1.append( "y", y );
        XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndex' );
        // Send our FormData object; HTTP headers are set automatically
        XHR1.send(FD1);
        XHR1.onload = function(){
            var x = XHR1.response
            console.log(x)
            //document.getElementById("res").innerHTML ="Contact Angle = "+ parseFloat(x).toFixed(4)+"<span>&#176;</span>";
      } 
    }
    function predictContour(){
      const XHR = new XMLHttpRequest(),
      FD  = new FormData();
      var x = document.getElementById("bstar").value;
      var y = document.getElementById("hstar").value;
      console.log("HELLO")
      // Push our data into our FormData object
      FD.append( "x_input", x );
      FD.append( "y_input", y );
      XHR.open( 'POST', 'http://127.0.0.1:5000/predict/contour' );
      // Send our FormData object; HTTP headers are set automatically
      XHR.send(FD);
      console.log("send")
      XHR.onload = function(){
          var x = JSON.parse(XHR.response)
          console.log(x)

          const XHR1 = new XMLHttpRequest(),
          FD1  = new FormData();
          var x1 = document.getElementById("bstar").value;
          var y1 = document.getElementById("hstar").value;
          console.log("HELLO")
          // Push our data into our FormData object
          FD1.append( "x", x1 );
          FD1.append( "y", y1 );
          XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/volumeContour' );
          // Send our FormData object; HTTP headers are set automatically
          XHR1.send(FD1);
          console.log("send")
          XHR1.onload = function(){
              var y = JSON.parse(XHR1.response)
              console.log(y)
              // myFunction(x,y)
                  const XHR2 = new XMLHttpRequest(),
                  FD2  = new FormData();
                  var x2 = document.getElementById("bstar").value;
                  var y2 = document.getElementById("hstar").value;
                  console.log("HELLO")
                  // Push our data into our FormData object
                  FD2.append( "x", x2 );
                  FD2.append( "y", y2 );
                  XHR2.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndexContour' );
                  // Send our FormData object; HTTP headers are set automatically
                  XHR2.send(FD2);
                  console.log("send")
                  XHR2.onload = function(){
                      var z = JSON.parse(XHR2.response)
                      console.log(z)
                      myFunction(x,y,z)
    }
          }
  }
}

    function clearData(){
      document.getElementById("angle").value=''
      document.getElementById("hstar").value='';
      document.getElementById("bstar").value='';
      document.getElementById("volume").value=''
      document.getElementById("tension").value=''
      document.getElementById("ag").value=''
      document.getElementById("density").value=''      
    }
    function mFunction(){
      let total_input = 0; 
      const contactAngle=document.getElementById("angle").value
      
      const h = document.getElementById("hstar").value;
      
      const b = document.getElementById("bstar").value;
      
      const volume=document.getElementById("volume").value
      
      
      const tension=document.getElementById("tension").value
      const ag=document.getElementById("ag").value
      const density=document.getElementById("density").value
      if (tension == "" || ag == "" || density == "") {
          alert("One or more of the required fields are empty!!");
          return false;
      }
      if(contactAngle){
        total_input = total_input+1;
      }
      if(h){
        total_input = total_input+1;
      }
      if(b){
        total_input = total_input+1;
      }
      if(volume){
        total_input = total_input+1;
      }
      if(total_input>2){
          alert("More than 2 input field have been given!! Please enter only two");
          return false;

      }
      if(total_input<2){
          alert("Less than 2 input field have been given!! Please enter only two");
          return false;

      }
      let lc=((tension*1.0)/(density*ag))
      lc=Math.sqrt(lc).toFixed(3)
      console.log({contactAngle,h,b,volume,lc})
      document.getElementById("lc").value=lc
      if(b && h){
          console.log("inside b and h")
          const FD1  = new FormData();
          const XHR1=new XMLHttpRequest()
          const XHR2=new XMLHttpRequest()
          const XHR3=new XMLHttpRequest()
          FD1.append( "x", b );
          FD1.append( "y", h );
          XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/contactAngle');
          // Send our FormData object; HTTP headers are set automatically
          XHR1.send(FD1);
          
          XHR1.onload = function(){
              var x = JSON.parse(XHR1.response)
              document.getElementById("angle").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
          }  
          XHR2.open( 'POST', 'http://127.0.0.1:5000/predict/volume');
          // Send our FormData object; HTTP headers are set automatically
          XHR2.send(FD1);  
          XHR2.onload = function(){
              var x = JSON.parse(XHR2.response)
              document.getElementById("volume").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
          }
          XHR3.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndex');
          // Send our FormData object; HTTP headers are set automatically
          XHR3.send(FD1);  
          XHR3.onload = function(){
              var x = JSON.parse(XHR3.response)
              console.log("shape index")
              console.log(x)
              document.getElementById("index").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
          }      
      }
      else if(contactAngle && h){
          const FD1  = new FormData();
          const XHR1=new XMLHttpRequest()
          const XHR3=new XMLHttpRequest()
          FD1.append( "x_input", contactAngle );
          FD1.append( "y_input", h );
          XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/bv');
          // Send our FormData object; HTTP headers are set automatically
          XHR1.send(FD1);
          XHR1.onload = function(){
              var x = JSON.parse(XHR1.response)
              document.getElementById("volume").value=x[1]
              document.getElementById("bstar").value=x[0]

              const h = document.getElementById("hstar").value;
              const b = document.getElementById("bstar").value;
              const tempFD  = new FormData();
              tempFD.append( "x", b );
              tempFD.append( "y", h );
              // XHR3=new XMLHttpRequest()
              XHR3.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndex');
              // Send our FormData object; HTTP headers are set automatically
              XHR3.send(tempFD);  
              XHR3.onload = function(){
                  var x = JSON.parse(XHR3.response)
                  console.log("shape index")
                  console.log(x)
                  document.getElementById("index").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
              }
          }         
      }
      else if(h && volume){
          const FD1  = new FormData();
          const XHR1=new XMLHttpRequest()
          FD1.append( "x_input", h );
          FD1.append( "y_input", volume );
          XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/cb');
          // Send our FormData object; HTTP headers are set automatically
          XHR1.send(FD1);
          XHR1.onload = function(){
              var x = JSON.parse(XHR1.response)
              document.getElementById("angle").value=x[1]
              document.getElementById("bstar").value=x[0]
              const h = document.getElementById("hstar").value;
              const b = document.getElementById("bstar").value;
              const tempFD  = new FormData();
              tempFD.append( "x", b );
              tempFD.append( "y", h );
              const XHR3=new XMLHttpRequest()
              // XHR3=new XMLHttpRequest()
              XHR3.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndex');
              // Send our FormData object; HTTP headers are set automatically
              XHR3.send(tempFD);  
              XHR3.onload = function(){
                  var x = JSON.parse(XHR3.response)
                  console.log("shape index")
                  console.log(x)
                  document.getElementById("index").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
              }
          }         
      }
      else if(b && volume){
          console.log('hi')
          const FD1  = new FormData();
          const XHR1=new XMLHttpRequest()
          FD1.append( "x_input", b );
          FD1.append( "y_input", volume );
          XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/ch');
          // Send our FormData object; HTTP headers are set automatically
          XHR1.send(FD1);
          XHR1.onload = function(){
              var x = JSON.parse(XHR1.response)
              document.getElementById("angle").value=x[1]
              document.getElementById("hstar").value=x[0]
              const h = document.getElementById("hstar").value;
              const b = document.getElementById("bstar").value;
              const tempFD  = new FormData();
              tempFD.append( "x", b );
              tempFD.append( "y", h );
              const XHR3=new XMLHttpRequest()
              // XHR3=new XMLHttpRequest()
              XHR3.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndex');
              // Send our FormData object; HTTP headers are set automatically
              XHR3.send(tempFD);  
              XHR3.onload = function(){
                  var x = JSON.parse(XHR3.response)
                  console.log("shape index")
                  console.log(x)
                  document.getElementById("index").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
              }
          }         
      }
      else if(contactAngle && b){
          const FD1  = new FormData();
          const XHR1=new XMLHttpRequest()
          FD1.append( "y_input", contactAngle );
          FD1.append( "x_input", b );
          XHR1.open( 'POST', 'http://127.0.0.1:5000/predict/hv');
          // Send our FormData object; HTTP headers are set automatically
          XHR1.send(FD1);
          XHR1.onload = function(){
              var x = JSON.parse(XHR1.response)
              document.getElementById("volume").value=x[1]
              document.getElementById("hstar").value=x[0]
              const h = document.getElementById("hstar").value;
              const b = document.getElementById("bstar").value;
              const tempFD  = new FormData();
              tempFD.append( "x", b );
              tempFD.append( "y", h );
              const XHR3=new XMLHttpRequest()
              // XHR3=new XMLHttpRequest()
              XHR3.open( 'POST', 'http://127.0.0.1:5000/predict/shapeIndex');
              // Send our FormData object; HTTP headers are set automatically
              XHR3.send(tempFD);  
              XHR3.onload = function(){
                  var x = JSON.parse(XHR3.response)
                  console.log("shape index")
                  console.log(x)
                  document.getElementById("index").value=x
              predictRegime()
              predictContactAngle()
              predictShapeIndex()
              predictContour()
              }
          }         
      }        
  }
    </script>
  
      <div class="d-flex justify-content-center"><h1 class="color-palette-heading col-lg-6 ">Digitised Tensiometric chart</h1></div>
     <div>
       <div class="p-3 mb-3" >
        <div class="d-flex justify-content-center"><h5 class="color-palette-heading col-lg-6 ">Below three fields are required.</h5></div> 
          <div class="input-data">
           
            <div class="textbox">
              <label for="hstar">Surface tension, &#963; (N/m) :</label>
              <input type="text" id="tension" name="fname" value="1" required><br><br>
            </div>
            <div class="textbox">
              <label for="bstar">Gravititational acceleration, g (m/s<sup>2</sup>):</label>
              <input type="text" id="ag" name="fname" value="9.8" required><br><br>
            </div>
              <div class="textbox">
              <label for="bstar">Density difference, &Delta;&rho; (Kg/m<sup>3</sup>) :</label>
              <input type="text" id="density" name="fname" value="1" required><br><br>
            </div>
                           
          </div>
        </div>
     </div>
     <div class="length">
      <label for="bstar">Critical length (L<sub>c</sub>) :</label>
        <input id="lc">
     </div>
     <div class="container-fluid container-background">
        <div>
        <div class="d-flex justify-content-center"><h5 class="color-palette-heading col-lg-6 ">Input any two of below fields.</h5></div>
            <div class="p-3 mb-3" >
                <div class="input-data">
                  <div class="textbox">
                    <label for="hstar">Height (h in mm):</label>
                    <input type="text" id="hstar" name="fname"><br><br>
                  </div>
                  <div class="textbox">
                    <label for="bstar">Base Radius (b in mm):</label>
                    <input type="text" id="bstar" name="fname"><br><br>
                  </div>
                  <div class="textbox">
                    <label for="bstar">Volume (V in <span>&#181;</span> L ):</label>
                    <input type="text" id="volume" name="fname"><br><br>
                  </div>
                  <div class="textbox">
                    <label for="bstar">Contact Angle:</label>
                    <input type="text" id="angle" name="fname"><br><br>
                  </div>
                  <div class="textbox">
                    <label for="bstar">Shape Index:</label>
                    <input type="text" id="index" name="fname"><br><br>
                  </div>                                    
                </div>
                <div class="buttons">
                  <div class="text-center" style="padding:40px"><button type="button" class="btn btn-primary"
                          onclick="mFunction()">Calculate!</button>
                  </div>
                  <div class="text-center"><button type="button" class="btn btn-primary"
                          onclick="clearData()">Clear data!</button>
                  </div>
                </div>                    
            </div>
        </div>     
        <div class="group">
          <div class="plotly-card p-3 mb-3" class="graph">
              <div id="tester"></div>
          </div>
          
          
        
        </div>
    </div>
</body>
<script src="js/plotly.js">
</script>

</html>
